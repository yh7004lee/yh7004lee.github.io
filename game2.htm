<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>말씀 단어 채우기 게임</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: '맑은 고딕', sans-serif;
      background-color: #121212;
      color: #f0f0f0;
      margin: 0;
      padding: 5px 20px;
    }
    h3 {
      font-size: 1.4rem;
      margin-top: 20px;
      margin-bottom: 10px;
    }
    p {
      font-size: 1.1rem;
      margin-bottom: 20px;
    }
    #verseText {
      font-size: 1.2rem;
      line-height: 1.8;
      margin-bottom: 20px;
      padding: 20px;
      background-color: #1e1e1e;
      border-radius: 12px;
      border: 2px dashed #555;
      min-height: 120px;
    }
    .input-word {
      display: block;
      margin: 10px auto;
      padding: 12px;
      font-size: 1rem;
      width: 100%;
      border: 1px solid #444;
      border-radius: 10px;
      background-color: #2c2c2c;
      color: #f0f0f0;
    }
    button {
      display: block;
      width: 100%;
      margin: 20px auto;
      padding: 12px;
      font-size: 1.1rem;
      background-color: #444;
      color: #fff;
      border: none;
      border-radius: 12px;
      cursor: pointer;
    }
    button:hover {
      background-color: #666;
    }
    #result {
      text-align: center;
      font-weight: bold;
      font-size: 1.2rem;
      margin-top: 20px;
    }
    #navButtons {
      display: flex;
      gap: 8px;
      margin-top: 10px;
    }
    .navBtn {
      flex: 1;
      padding: 10px 0;
      font-size: 1rem;
      background-color: #444;
      color: #f0f0f0;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    .navBtn:hover {
      background-color: #666;
    }
  </style>
</head>
<body>
  <div id="navButtons">
    <button class="navBtn" onclick="goToFirst()">처음</button>
    <button class="navBtn" onclick="goToPrev()">이전</button>
    <button class="navBtn" onclick="goToNext()">다음</button>
    <button class="navBtn" onclick="goToLast()">마지막</button>
  </div>

  <h3 id="verseTitle">말씀 제목</h3>
  <div id="verseText"></div>

  <input class="input-word" placeholder="첫 번째 단어를 입력하세요">
  <input class="input-word" placeholder="두 번째 단어를 입력하세요">
  <input class="input-word" placeholder="세 번째 단어를 입력하세요">
  <input class="input-word" placeholder="네 번째 단어를 입력하세요">

  <button onclick="checkAnswers()">✅ 정답 확인</button>

  <div id="result"></div>

  <script>
    const STORAGE_KEY = 'savedVerses2';
    let verses = [];
    let currentStage = 0;
    let hiddenWords = [];

    function loadVerses() {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (!saved) return [];
      try {
        return JSON.parse(saved);
      } catch {
        return [];
      }
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function renderStage() {
      const verse = verses[currentStage];
      document.getElementById('verseTitle').textContent = verse.title || `스테이지 ${currentStage + 1}`;

      const words = verse.text.trim().split(/\s+/);
      const indexes = shuffle([...Array(words.length).keys()]).slice(0, 4);
      hiddenWords = indexes.map(i => words[i]);
      const displayWords = words.map((word, i) => indexes.includes(i) ? '_____' : word);

      document.getElementById('verseText').textContent = displayWords.join(' ');

      const inputs = document.querySelectorAll('.input-word');
      inputs.forEach(input => input.value = '');
      document.getElementById('result').textContent = '';
    }

function checkAnswers() {
  const inputs = document.querySelectorAll('.input-word');
  let correctCount = 0;

  inputs.forEach((input, idx) => {
    const userAnswer = input.value.trim();
    const correctAnswer = hiddenWords[idx];

    if (userAnswer === correctAnswer) {
      input.style.backgroundColor = '#2c2c2c'; // 원래 색상 유지
      input.style.color = '#f0f0f0';
      correctCount++;
    input.disabled = true;
    } else {
      input.style.backgroundColor = '#3a3a3a'; // 살짝 밝은 오답 표시
      input.style.color = '#f0f0f0';
    }


  });

  if (correctCount === 4) {
    alert(`🎉 ${correctCount}개 정답입니다! 다음 문제로 넘어갑니다.`);

    // 정답 맞춘 후 모든 인풋 원래 색상으로 복구
    inputs.forEach(input => {
      input.style.backgroundColor = '#2c2c2c';
      input.style.color = '#f0f0f0';
    });

    setTimeout(() => {
      goToNext();
    }, 500);
  } else {
    alert(`${correctCount}개 정답입니다. 다시 확인해보세요.`);
  }
}



    function goToFirst() {
      currentStage = 0;
      renderStage();
    }
    function goToPrev() {
      if (currentStage > 0) currentStage--;
      renderStage();
    }
    function goToNext() {
      if (currentStage < verses.length - 1) currentStage++;
      renderStage();
    }
    function goToLast() {
      currentStage = verses.length - 1;
      renderStage();
    }

    window.onload = () => {
      verses = loadVerses();
      if (verses && verses.length > 0) {
        renderStage();
      } else {
        document.getElementById('verseText').textContent = '저장된 말씀이 없습니다.';
      }
    };
  </script>
</body>
</html>