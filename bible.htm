<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>성경 암송 카드</title>
<style>

* {
  box-sizing: border-box;
}

html, body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
}
body {
  background-color: #121212;
  color: #fff;
  display: flex;
  flex-direction: column;
  margin: 0;
  padding: 0;
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

/* 상단 버튼 스타일 */
.top-buttons {
  display: flex;
  justify-content: space-between; /* 버튼을 좌우로 최대한 벌림 */
   align-items: center; /* <-- stretch에서 center로 변경 */
  background-color: #1e1e1e;
  padding: 0;
  z-index: 2;
}




.top-buttons button {
  flex: 1; /* 버튼 너비를 균등하게 만듦 */
  text-align: center; /* 버튼 안의 텍스트 중앙 정렬 */
  padding: 0 20px;
  height: 40px;
  line-height: 40px;
  vertical-align: middle;
  background: none;
  border: none;
  color: #fff;
  font-size: 1.1rem;
  cursor: pointer;
  border-right: 1px solid #333333;
  border-radius: 0;
  transition: background-color 1s ease, color 0.3s ease; /* ✅ transition 수정 */
}

/* 클릭(또는 터치) 시 효과 */
.top-buttons button:active {
  background-color: rgba(197, 79, 109, 0.8); /* ✅ 약간의 투명도 (0.7) 추가 */
  transition: background-color 1s ease; /* ✅ transition 추가 */
}


/* 호버 효과는 그대로 유지 */
.top-buttons button:hover,
.top-buttons button:focus {
  background-color: rgba(197, 79, 109, 0.8);✅ 약간의 투명도 (0.7) 추가 */
}



/* 하단 버튼 스타일 */
.bottom-buttons {
  display: flex;
  justify-content: space-around;
  background-color: #1e1e1e;
  padding: 10px 0;
  z-index: 2;
}

.bottom-buttons button {
  background: none;
  border: none;
  color: #fff;
  font-size: 1.1rem;
  cursor: pointer;
  transition: background-color 0.3s ease, color 0.3s ease;
  border-radius: 8px;
}

.bottom-buttons button:hover,
.bottom-buttons button:focus {
  background-color: #2a2a2a;
}

.bottom-buttons button:active {
  background-color: #333333;
}

.verse-container {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  padding: 14px 0 40px 0;
  gap: 14px;
  overflow-y: auto;
  overflow-x: hidden;
  touch-action: pan-y;
  margin: 50 0 0 0;  /* 🔧 상단 마진 50px */
  box-sizing: border-box;
}




.verse-box, 
.favorite-box {
 /*height: auto; */
  width: 100%;
  margin: 0 ;
  padding: 10px ;
  box-sizing: border-box;


}


.verse-box {
  background: #1e1e1e;
  /*border-radius: 15px;*/
  text-align: left;
  cursor: pointer;
}


.favorite-box {
  display: flex;
  align-items: center;
  gap: 10px; /* 간격 조절 */
  background: #1e1e1e;
   /*border-radius: 15px;*/
  cursor: pointer;
}




.verse-title {
  font-size: 1.6rem;
  /*font-weight: bold;*/
  color: #FFF; /* 주황빛 노랑 */
  margin: 0;
}

.verse-text {
  font-size: 1.6rem;
  line-height: 2.4rem;
   /*font-weight: bold;*/
  color: #FFF; /* 연녹색 */
  margin: 0;
}



.favorite-label {
  font-size: 1.6rem;
  color: #fff; /* 연하늘색 */
   /*font-weight: bold;*/
}




/* 체크박스 크기 조정 */
#favoriteCheckbox {
  width: 17px;
  height: 17px;
  transform: scale(1.5);
}




/* 말씀 편집 모드 스타일 */
.edit-container {
  position: fixed;
  top: 0; /* 수정: 기존 60px -> 0 */
  bottom: 0;
  left: 0;
  right: 0;
  background-color: #121212;
  padding: 10px 15px 20px 15px;
  display: flex;
  flex-direction: column;
  z-index: 5;
  overflow: auto;
}

.edit-title {
  font-size: 1.4rem;
  color: #fff;
 font-weight: normal; /* 굵게 보이지 않도록 설정 */
  margin: 0;
  padding-top: 4px;
  padding-left: 10px;
  padding-bottom: 6px;
}

#editTextarea {
  flex: 1;
  width: 100%;
  resize: none;
  font-size: 1rem;
  padding: 10px;
  background-color: #1e1e1e;
  color: #fff;
  border: 1px solid #444;
  border-radius: 10px;
  box-sizing: border-box;
}

.edit-buttons {
  display: flex;
  justify-content: space-around;
  margin-top: 15px;
}

.edit-buttons button {
  flex: 1;
  margin: 0 5px;
  padding: 10px;
  font-size: 1.1rem;
  border: none;
  border-radius: 8px;
  background-color: #2a2a2a;
  color: #fff;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.edit-buttons button:hover {
  background-color: #333333;
}

@media (max-width: 768px) {
  #editTextarea {
    font-size: 1rem;
  }

  .edit-title {
    font-size: 1.2rem;
  }
}

.verse-box.animate-left,
.favorite-box.animate-left {
  animation: slideLeft 0.7s ease;
}

.verse-box.animate-right,
.favorite-box.animate-right {
  animation: slideRight 0.7s ease;
}

@keyframes slideLeft {
  0% {
    opacity: 0;
    transform: translateX(50px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideRight {
  0% {
    opacity: 0;
    transform: translateX(-50px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
}


#settingsMenu {
  display: none;
  position: absolute;
  top: 48px;
  right: 10px;
  width: 90vw;
  max-width: 300px;
  background-color: #1e1e1e;
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 14px;
  padding: 5px 12px;
box-shadow:
  /* 네온 광채 - 더 밝고 선명하게 */
  0 0 4px rgba(0, 255, 255, 0.8),   /* 형광 청록빛 */
  0 0 8px rgba(0, 255, 255, 0.6),
  0 0 16px rgba(0, 255, 255, 0.5),
  0 0 24px rgba(0, 255, 255, 0.3),

  /* 아래로 드리운 어두운 그림자 */
  0 10px 20px rgba(0, 0, 0, 0.5);
  
z-index: 10000;
  animation: fadeInMenu 0.3s ease-out;
}

@keyframes fadeInMenu {
  from {
    opacity: 0;
    transform: translateY(-10px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

#settingsMenu h3 {
  font-size: 1.2rem;
  color: #ffffff;
  margin-top: 0;
  margin-bottom: 10px;
  padding-bottom: 6px;
  border-bottom: 1px solid #333;
}

#settingsMenu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

#settingsMenu ul li {
  padding: 10px 14px;
  margin-bottom: 6px;
  background-color: #262626;
  border-radius: 10px;
  color: #eee;
  font-size: 1rem;
  cursor: pointer;
  transition: background-color 0.25s ease;
}

#settingsMenu ul li:hover {
  background-color: #333;
  color: #03dac6;
}

#settingsMenu ul li:active {
  background-color: #444;
}



/* 메뉴 항목 */
.settings-item {
  padding: 10px 10px;
  font-size: 1.1rem;
  color: #fff;
  background-color: transparent;
  user-select: none;
  cursor: pointer;
  transition: background-color 0.3s ease;
  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

/* 마지막 항목은 보더 제거 */
.settings-item:last-child {
  border-bottom: none;
}

/* 호버 효과 */
.settings-item:hover {
  background-color: #c54f6d;
}

/* 슬라이더 */
.settings-item input[type="range"] {
  width: 100%;
  margin-top: 6px;
  cursor: pointer;
}

</style>
</head>
<body>

<div class="top-buttons">
  <button id="toggleButton" onclick="toggleVerse()">숨겨</button>
  <button id="modeToggleButton" onclick="toggleMode()">랜덤</button>
  <button id="favoriteToggleButton" onclick="toggleFavorites()">즐찾</button>
<button id="settingsToggleButton" onclick="toggleSettingsMenu()">설정</button>
</div>


<div id="settingsMenu">
  <div class="inner-container">
 <div class="settings-item"  id="game1" onclick="game1()">🎮 블럭 옮기기 게임</div> 
 <div class="settings-item"  id="game2" onclick="game2()">🎮 빈칸 입력 게임</div> 
 <div class="settings-item"  id="game3" onclick="game3()">🎮 순서대로 터치 게임</div> 
    <div class="settings-item" onclick="handleEditClick()">📖 말씀 편집하기</div>

    <div class="settings-item">
      📖 말씀구절 글자크기
      <input id="titleFontSlider" type="range" min="1" max="6" value="1">
    </div>
    <div class="settings-item">
      📖 말씀내용 글자크기
      <input id="textFontSlider" type="range" min="1" max="6" value="1">
    </div>
    <div class="settings-item" onclick="resetFontSizes()">📖 글자크기 초기화</div>
 <div class="settings-item" id="krEnBtn" onclick="krEnVerse()">📖 메인/보조말씀 위치변경</div>
 <div class="settings-item" id="toggleEnglishVerseBtn" onclick="toggleEnglishVerse()">📖 보조말씀 숨기기</div>
  
<div class="settings-item" onclick="openHelpPopup()">💗 도움말</div>
    <div class="settings-item" onclick="hideSettingsMenu()">💗 나가기</div>
  </div>
</div>



<div class="verse-container" id="verseContainer">
  <div class="verse-box">
    <div class="verse-title" id="verseTitle"></div>
  </div>
  <div class="verse-box">
    <div class="verse-text" id="verseText"></div>
  </div>
     <div class="verse-box">
    <div class="verse-text" id="verseTextEn"></div>
  </div>
  <div class="favorite-box" onclick="toggleFavoriteCheckbox()">
    <span class="favorite-label">즐겨찾기 추가  </span>
    <input type="checkbox" id="favoriteCheckbox" onclick="event.stopPropagation(); updateFavorite();">
  </div>
</div>









<div id="editContainer" class="edit-container" style="display: none;">
  <h2 class="edit-title">편집 형식 : 말씀구절 | 한글 | 영문</h2>
  <textarea id="editTextarea"></textarea>
  <div class="edit-buttons">
    <button onclick="saveEditedVerses()">확인</button>
    <button onclick="cancelEdit()">취소</button>
    <button onclick="resetToOriginal()">초기화</button>
  </div>
</div>


<script>



let settingsVisible = false;

function toggleSettingsMenu() {
  const menu = document.getElementById("settingsMenu");
  settingsVisible = !settingsVisible;
  menu.style.display = settingsVisible ? "block" : "none";
}

document.addEventListener("click", function (event) {
  const menu = document.getElementById("settingsMenu");
  const button = document.getElementById("settingsToggleButton");
  if (!menu.contains(event.target) && event.target !== button) {
    menu.style.display = "none";
    settingsVisible = false;
  }
});

function handleEditClick() {
  toggleEditMode();
  hideSettingsMenu();
}

function hideSettingsMenu() {
  document.getElementById("settingsMenu").style.display = "none";
  settingsVisible = false;
}

// 글자 크기 조절 슬라이더와 저장 로직
const titleFontSlider = document.getElementById("titleFontSlider");
const textFontSlider = document.getElementById("textFontSlider");
const verseTitle = document.getElementById("verseTitle");
const verseText = document.getElementById("verseText");

function applyFontSize() {
  const titleScale = parseInt(titleFontSlider.value);
  const textScale = parseInt(textFontSlider.value);

  const titleSize = 1.6 + (titleScale - 1) * 0.2;
  const textSize = 1.6 + (textScale - 1) * 0.2;

  verseTitle.style.fontSize = `${titleSize}rem`;
  verseTitle.style.lineHeight = `${titleSize * 1.4}rem`; // 줄간격 설정
  verseText.style.fontSize = `${textSize}rem`;
  verseText.style.lineHeight = `${textSize * 1.5}rem`; // 줄간격 설정
  verseTextEn.style.fontSize = `${textSize}rem`;
  verseTextEn.style.lineHeight = `${textSize * 1.5}rem`; // 줄간격 설정
  localStorage.setItem("verseTitleSize", titleScale);
  localStorage.setItem("verseTextSize", textScale);
}

titleFontSlider.addEventListener("input", applyFontSize);
textFontSlider.addEventListener("input", applyFontSize);

function resetFontSizes() {
  titleFontSlider.value = 1;
  textFontSlider.value = 1;
  applyFontSize();
}

window.addEventListener("load", () => {
  const savedTitleSize = localStorage.getItem("verseTitleSize") || 1;
  const savedTextSize = localStorage.getItem("verseTextSize") || 1;

  titleFontSlider.value = savedTitleSize;
  textFontSlider.value = savedTextSize;

  applyFontSize();
});

document.getElementById("titleFontSlider").addEventListener("input", function () {
  const scale = parseInt(this.value);
  const verseTitle = document.getElementById("verseTitle");
  const fontSize = 1.4 + 0.2 * scale;
  const lineHeight = fontSize * 1.4; // 줄간격 비율
  verseTitle.style.fontSize = fontSize + "rem";
  verseTitle.style.lineHeight = lineHeight + "rem";
});

document.getElementById("textFontSlider").addEventListener("input", function () {
  const scale = parseInt(this.value);
  const verseText = document.getElementById("verseText");
  const verseTextEn = document.getElementById("verseTextEn");
  const fontSize = 1.4 + 0.2 * scale;
  const lineHeight = fontSize * 1.5; // 줄간격 비율
  verseText.style.fontSize = fontSize + "rem";
  verseText.style.lineHeight = lineHeight + "rem";
  verseTextEn.style.fontSize = fontSize + "rem";
  verseTextEn.style.lineHeight = lineHeight + "rem";
});


// localStorage key
const STORAGE_KEY_VERSES = 'savedVerses2';
const STORAGE_KEY_FAVORITES = 'favorites2';

// 로컬스토리지에서 저장된 말씀 불러오기
function loadSavedVerses() {
  const saved = localStorage.getItem(STORAGE_KEY_VERSES);
  if (!saved) return null;

  try {
    const parsed = JSON.parse(saved);
    return parsed.map((v, i) => ({
      ...v,
      id: i,
      title: v.title || '',
      text: v.text || '',
      textEn: v.textEn || '',
      favorite: v.favorite || false
    }));
  } catch {
    return null;
  }
}

function saveVersesToStorage(verses) {
  localStorage.setItem(STORAGE_KEY_VERSES, JSON.stringify(verses));
}


// 기본 말씀 구절 문자열
const originalVersesStr = `
1. 요한복음 3장 16절| 하나님이 세상을 이처럼 사랑하사 독생자를 주셨으니 이는 저를 믿는 자마다 멸망치 않고 영생을 얻게 하려 하심이니라 [개역한글] | For God so loved the world, that he gave his only begotten Son, that whosoever believeth in him should not perish, but have everlasting life. [KJV]
2. 요한복음 14장 6절| 예수께서 가라사대 내가 곧 길이요 진리요 생명이니 나로 말미암지 않고는 아버지께로 올 자가 없느니라 [개역한글] | Jesus saith unto him, I am the way, the truth, and the life: no man cometh unto the Father, but by me. [KJV]
3. 로마서 5장 8절| 우리가 아직 죄인 되었을 때에 그리스도께서 우리를 위하여 죽으심으로 하나님께서 우리에게 대한 자기의 사랑을 확증하셨느니라 [개역한글] | But God commendeth his love toward us, in that, while we were yet sinners, Christ died for us. [KJV]
4. 히브리서 11장 6절| 믿음이 없이는 기쁘시게 못하나니 하나님께 나아가는 자는 반드시 그가 계신 것과 또한 그가 자기를 찾는 자들에게 상 주시는 이심을 믿어야 할찌니라 [개역한글]| But without faith it is impossible to please him: for he that cometh to God must believe that he is, and that he is a rewarder of them that diligently seek him. [KJV]
5. 마태복음 6장 33절| 너희는 먼저 그의 나라와 그의 의를 구하라 그리하면 이 모든 것을 너희에게 더하시리라  [개역한글]| But seek ye first the kingdom of God, and his righteousness; and all these things shall be added unto you.  [KJV]
6. 데살로니가전서 5장 16~18절| 항상 기뻐하라 쉬지 말고 기도하라 범사에 감사하라 이는 그리스도 예수 안에서 너희를 향하신 하나님의 뜻이니라  [개역한글]| Rejoice evermore.Pray without ceasing. In every thing give thanks: for this is the will of God in Christ Jesus concerning you.  [KJV]
7. 사도행전 1장 8절| 오직 성령이 너희에게 임하시면 너희가 권능을 받고 예루살렘과 온 유대와 사마리아와 땅 끝까지 이르러 내 증인이 되리라 하시니라  [개역한글]| But ye shall receive power, after that the Holy Ghost is come upon you: and ye shall be witnesses unto me both in Jerusalem, and in all Judaea, and in Samaria, and unto the uttermost part of the earth.  [KJV]
8. 요한복음 15장 5절| 나는 포도나무요 너희는 가지니 저가 내 안에, 내가 저 안에 있으면 이 사람은 과실을 많이 맺나니 나를 떠나서는 너희가 아무것도 할 수 없음이라  [개역한글]| I am the vine, ye are the branches: He that abideth in me, and I in him, the same bringeth forth much fruit: for without me ye can do nothing.  [KJV]
9. 갈라디아서 2장 20절| 내가 그리스도와 함께 십자가에 못 박혔나니 그런즉 이제는 내가 산 것이 아니요 오직 내 안에 그리스도께서 사신 것이라 이제 내가 육체 가운데 사는 것은 나를 사랑하사 나를 위하여 자기 몸을 버리신 하나님의 아들을 믿는 믿음 안에서 사는 것이라  [개역한글]| I am crucified with Christ: neverthless I live; yet not I, but Christ liveth in me: and the life which I now live in the flesh I live by the faith of the Son of God, who loved me, and gave himself for me.  [KJV]
10. 이사야 41장 10절| 두려워 말라 내가 너와 함께 함이니라 놀라지 말라 나는 네 하나님이 됨이니라 내가 너를 굳세게 하리라 참으로 너를 도와 주리라 참으로 나의 의로운 오른손으로 너를 붙들리라  [개역한글]| Fear thou not; for I am with thee: be not dismayed; for I am thy God: I will strengthen thee; yea, I will help thee; yea, I will uphold thee with the right hand of my righteousness.  [KJV]
11. 예레미야 33장 3절| 너는 내게 부르짖으라 내가 네게 응답하겠고 네가 알지 못하는 크고 비밀한 일을 네게 보이리라  [개역한글]| Call unto me, and I will answer thee, and shew thee great and mighty things, which thou knowest not.  [KJV]
12. 빌립보서 4장 19절| 나의 하나님이 그리스도 예수 안에서 영광 가운데 그 풍성한대로 너희 모든 쓸 것을 채우시리라  [개역한글]| But my God shall supply all your need according to his riches in glory by Christ Jesus.  [KJV]
13. 요한일서 2장 15~16절 | 이 세상이나 세상에 있는 것들을 사랑치 말라 누구든지 세상을 사랑하면 아버지의 사랑이 그 속에 있지 아니하니 이는 세상에 있는 모든 것이 육신의 정욕과 안목의 정욕과 이생의 자랑이니 다 아버지께로 좇아 온 것이 아니요 세상으로 좇아 온 것이라  [개역한글]| Love not the world, neither the things that are in the world. If any man love the world, the love of the Father is not in him. For all that is in the world, the lust of the flesh, and the lust of the eyes, and the pride of life, is not of the Father, but is of the world.  [KJV]
14. 빌립보서 2장 3~4절| 아무 일에든지 다툼이나 허영으로 하지 말고 오직 겸손한 마음으로 각각 자기보다 남을 낫게 여기고 각각 자기 일을 돌아볼 뿐더러 또한 각각 다른 사람들의 일을 돌아보아 나의 기쁨을 충만케 하라  [개역한글]| Let nothing be done through strife or vainglory; but in lowliness of mind let each esteem other better than themselves. Look not every man on his own things, but every man also on the things of others.  [KJV]
15. 요한복음 15장 7절| 너희가 내 안에 거하고 내 말이 너희 안에 거하면 무엇이든지 원하는대로 구하라 그리하면 이루리라  [개역한글]| If ye abide in me, and my words abide in you, ye shall ask what ye will, and it shall be done unto you.  [KJV]
16. 잠언 4장 8절| 그를 높이라 그리하면 그가 너를 높이 들리라 만일 그를 품으면 그가 너를 영화롭게 하리라  [개역한글]| Exalt her, and she shall promote thee: she shall bring thee to honour, when thou dost embrace her.  [KJV]
17. 에베소서 4장 29절| 무릇 더러운 말은 너희 입밖에도 내지 말고 오직 덕을 세우는데 소용되는대로 선한 말을 하여 듣는 자들에게 은혜를 끼치게 하라  [개역한글]| Let no corrupt communication proceed out of your mouth, but that which is good to the use of edifying, that it may minister grace unto the hearers.  [KJV]
18. 요한일서 5장 4절| 대저 하나님께로서 난 자마다 세상을 이기느니라 세상을 이긴 이김은 이것이니 우리의 믿음이니라  [개역한글]| For whatsoever is born of God overcometh the world: and this is the victory that overcometh the world, even our faith.  [KJV]
19. 마태복음 7장 7절| 구하라 그러면 너희에게 주실 것이요 찾으라 그러면 찾을 것이요 문을 두드리라 그러면 너희에게 열릴 것이니  [개역한글]| Ask, and it shall be given you; seek, and ye shall find; knock, and it shall be opened unto you:  [KJV]
20. 잠언 16장 20절| 삼가 말씀에 주의하는 자는 좋은 것을 얻나니 여호와를 의지하는 자가 복이 있느니라  [개역한글]| He that handleth a matter wisely shall find good: and whoso trusteth in the LORD, happy is he.ㅋ  [KJV]
21. 시편 46편 1절| 하나님은 우리의 피난처시요 힘이시니 환난 중에 만날 큰 도움이시라  [개역한글]| God is our refuge and strength, a very present help in trouble.  [KJV]
22. 로마서 10장 10절| 사람이 마음으로 믿어 의에 이르고 입으로 시인하여 구원에 이르느니라  [개역한글]| For with the heart man believeth unto righteousness; and with the mouth confession is made unto salvation.  [KJV]
23. 이사야 53장 5절| 그가 찔림은 우리의 허물을 인함이요 그가 상함은 우리의 죄악을 인함이라 그가 징계를 받음으로 우리가 평화를 누리고 그가 채찍에 맞음으로 우리가 나음을 입었도다  [개역한글]| But he was wounded for our transgressions, he was bruised for our iniquities: the chastisement of our peace was upon him; and with his stripes we are healed.  [KJV]
24. 잠언 16장 9절| 사람이 마음으로 자기의 길을 계획할지라도 그 걸음을 인도하는 자는 여호와시니라  [개역한글]| A man's heart deviseth his way: but the LORD directeth his steps.  [KJV]
25. 빌립보서 4장 6~7절| 아무 것도 염려하지 말고 오직 모든 일에 기도와 간구로, 너희 구할 것을 감사함으로 하나님께 아뢰라 그리하면 모든 지각에 뛰어난 하나님의 평강이 그리스도 예수 안에서 너희 마음과 생각을 지키시리라  [개역한글]| Be careful for nothing; but in every thing by prayer and supplication with thanksgiving let your requests be made known unto God. And the peace of God, which passeth all understanding, shall keep your hearts and minds through Christ Jesus.  [KJV]
26. 이사야 40장 31절| 오직 여호와를 앙망하는 자는 새 힘을 얻으리니 독수리의 날개치며 올라감 같을 것이요 달음박질하여도 곤비치 아니하겠고 걸어가도 피곤치 아니하리로다  [개역한글]| But they that wait upon the LORD shall renew their strength; they shall mount up with wings as eagles; they shall run, and not be weary; and they shall walk, and not faint.  [KJV]
27. 마태복음 11장 28절| 수고하고 무거운 짐진 자들아 다 내게로 오라 내가 너희를 쉬게 하리라  [개역한글]| Come unto me, all ye that labour and are heavy laden, and I will give you rest.  [KJV]
28. 마태복음 22장 37절| 예수께서 가라사대 네 마음을 다하고 목숨을 다하고 뜻을 다하여 주 너의 하나님을 사랑하라 하셨으니  [개역한글]| Jesus said unto him, Thou shalt love the Lord thy God with all thy heart, and with all thy soul, and with all thy mind.  [KJV]
29. 요한복음 14장 13절| 너희가 내 이름으로 무엇을 구하든지 내가 시행하리니 이는 아버지로 하여금 아들을 인하여 영광을 얻으시게 하려 함이라  [개역한글]| And whatsoever ye shall ask in my name, that will I do, that the Father may be glorified in the Son.  [KJV]
30. 빌립보서 4장 13절| 내게 능력 주시는 자 안에서 내가 모든 것을 할 수 있느니라  [개역한글]| I can do all things through Christ which strengtheneth me.  [KJV]
`;



const originalVersesStr2 = `1. 고린도후서 5장 17절| 그런즉 누구든지 그리스도 안에 있으면 새로운 피조물이라 이전 것은 지나갔으니 보라 새 것이 되었도다 |Therefore, if anyone is in Christ, he is a new creation; the old has gone, the new has come!
2. 갈라디아서 2장 20절| 내가 그리스도와 함께 십자가에 못 박혔나니 그런즉 이제는 내가 사는 것이 아니요 오직 내 안에 그리스도께서 사시는 것이라 이제 내가 육체 가운데 사는 것은 나를 사랑하사 나를 위하여 자기 자신을 버리신 하나님의 아들을 믿는 믿음 안에서 사는 것이라 |I have been crucified with Christ and I no longer live, but Christ lives in me. The life I live in the body, I live by faith in the Son of God, who loved me and gave himself for me.
3. 로마서 12장 1절| 그러므로 형제들아 내가 하나님의 모든 자비하심으로 너희를 권하노니 너희 몸을 하나님이 기뻐하시는 거룩한 산 제물로 드리라 이는 너희가 드릴 영적 예배니라 |Therefore, I urge you, brothers, in view of God's mercy, to offer your bodies as living sacrifices, holy and pleasing to God--this is your spiritual act of worship.
4. 요한복음 14장 21절| 나의 계명을 지키는 자라야 나를 사랑하는 자니 나를 사랑하는 자는 내 아버지께 사랑을 받을 것이요 나도 그를 사랑하여 그에게 나를 나타내리라 |Whoever has my commands and obeys them, he is the one who loves me. He who loves me will be loved by my Father, and I too will love him and show myself to him.
5. 디모데후서 3장 16절| 모든 성경은 하나님의 감동으로 된 것으로 교훈과 책망과 바르게 함과 의로 교육하기에 유익하니 |All Scripture is God-breathed and is useful for teaching, rebuking, correcting and training in righteousness,
6. 여호수아 1장 8절| 이 율법책을 네 입에서 떠나지 말게 하며 주야로 그것을 묵상하여 그 안에 기록된 대로 다 지켜 행하라 그리하면 네 길이 평탄하게 될 것이며 네가 형통하리라 |Do not let this Book of the Law depart from your mouth; meditate on it day and night, so that you may be careful to do everything written in it. Then you will be prosperous and successful.
7. 요한복음 15장 7절| 너희가 내 안에 거하고 내 말이 너희 안에 거하면 무엇이든지 원하는 대로 구하라 그리하면 이루리라 |If you remain in me and my words remain in you, ask whatever you wish, and it will be given you.
8. 빌립보서 4장 6-7절| 아무 것도 염려하지 말고 다만 모든 일에 기도와 간구로 너희 구할 것을 감사함으로 하나님께 아뢰라 그리하면 모든 지각에 뛰어난 하나님의 평강이 그리스도 예수 안에서 너희 마음과 생각을 지키시리라 |Do not be anxious about anything, but in everything, by prayer and petition, with thanksgiving, present your requests to God. And the peace of God, which transcends all understanding, will guard your hearts and your minds in Christ Jesus.
9. 마태복음 18장 20절| 두세 사람이 내 이름으로 모인 곳에는 나도 그들 중에 있느니라 |For where two or three come together in my name, there am I with them.
10. 히브리서 10장 24-25절| 서로 돌아보아 사랑과 선행을 격려하며 모이기를 폐하는 어떤 사람들의 습관과 같이 하지 말고 오직 권하여 그 날이 가까움을 볼수록 더욱 그리하자 |And let us consider how we may spur one another on toward love and good deeds. Let us not give up meeting together, as some are in the habit of doing, but let us encourage one another--and all the more as you see the Day approaching.
11. 마태복음 4장 19절| 말씀하시되 나를 따라오라 내가 너희를 사람을 낚는 어부가 되게 하리라 하시니 |Therefore
12. 로마서 1장 16절| 내가 복음을 부끄러워하지 아니하노니 이 복음은 모든 믿는 자에게 구원을 주시는 하나님의 능력이 됨이라 먼저는 유대인에게요 그리고 헬라인에게로다 |I am not ashamed of the gospel, because it is the power of God for the salvation of everyone who believes: first for the Jew, then for the Gentile.
13. 로마서 3장 23절| 모든 사람이 죄를 범하였으매 하나님의 영광에 이르지 못하더니 |for all have sinned and fall short of the glory of God,
14. 이사야 53장 6절| 우리는 다 양 같아서 그릇 행하여 각기 제 길로 갔거늘 여호와께서는 우리 모두의 죄악을 그에게 담당시키셨도다 |We all, like sheep, have gone astray, each of us has turned to his own way; and the LORD has laid on him the iniquity of us all.
15. 로마서 6장 23절| 죄의 삯은 사망이요 하나님의 은사는 그리스도 예수 우리 주 안에 있는 영생이니라 |For the wages of sin is death, but the gift of God is eternal life in Christ Jesus our Lord.
16. 히브리서 9장 27절| 한번 죽는 것은 사람에게 정해진 것이요 그 후에는 심판이 있으리니 |Just as man is destined to die once, and after that to face judgment,
17 로마서 5장 8절| 우리가 아직 죄인 되었을 때에 그리스도께서 우리를 위하여 죽으심으로 하나님께서 우리에 대한 자기의 사랑을 확증하셨느니라 |But God demonstrates his own love for us in this: While we were still sinners, Christ died for us.
18. 베드로전서 3장 18절| 그리스도께서도 단번에 죄를 위하여 죽으사 의인으로서 불의한 자를 대신하셨으니 이는 우리를 하나님 앞으로 인도하려 하심이라 육체로는 죽임을 당하시고 영으로는 살리심을 받으셨으니 |For Christ died for sins once for all, the righteous for the unrighteous, to bring you to God. He was put to death in the body but made alive by the Spirit,
19. 에베소서 2장 8-9절| 너희는 그 은혜에 의하여 믿음으로 말미암아 구원을 받았으니 이것은 너희에게서 난 것이 아니요 하나님의 선물이라 행위에서 난 것이 아니니 이는 누구든지 자랑하지 못하게 함이라 |For it is by grace you have been saved, through faith--and this not from yourselves, it is the gift of God-- not by works, so that no one can boast.
20. 디도서 3장 5절| 우리를 구원하시되 우리가 행한 바 의로운 행위로 말미암지 아니하고 오직 그의 긍휼하심을 따라 중생의 씻음과 성령의 새롭게 하심으로 하셨나니 |he saved us, not because of righteous things we had done, but because of his mercy. He saved us through the washing of rebirth and renewal by the Holy Spirit,
21. 요한복음 1장 12절| 영접하는 자 곧 그 이름을 믿는 자들에게는 하나님의 자녀가 되는 권세를 주셨으니 |Yet to all who received him, to those who believed in his name, he gave the right to become children of God--
22. 요한계시록 3장 20절| 볼지어다 내가 문 밖에 서서 두드리노니 누구든지 내 음성을 듣고 문을 열면 내가 그에게로 들어가 그와 더불어 먹고 그는 나와 더불어 먹으리라 |Here I am! I stand at the door and knock. If anyone hears my voice and opens the door, I will come in and eat with him, and he with me.
23. 요한일서 5장 13절| 내가 하나님의 아들의 이름을 믿는 너희에게 이것을 쓰는 것은 너희로 하여금 너희에게 영생이 있음을 알게 하려 함이라 |I write these things to you who believe in the name of the Son of God so that you may know that you have eternal life.
24. 요한복음 5장 24절| 내가 진실로 진실로 너희에게 이르노니 내 말을 듣고 또 나 보내신 이를 믿는 자는 영생을 얻었고 심판에 이르지 아니하나니 사망에서 생명으로 옮겼느니라 |I tell you the truth, whoever hears my word and believes him who sent me has eternal life and will not be condemned; he has crossed over from death to life.
25. 고린도전서 3장 16절| 너희는 너희가 하나님의 성전인 것과 하나님의 성령이 너희 안에 계시는 것을 알지 못하느냐 |Don't you know that you yourselves are God's temple and that God's Spirit lives in you?
26 고린도전서 2장 12절| 우리가 세상의 영을 받지 아니하고 오직 하나님으로부터 온 영을 받았으니 이는 우리로 하여금 하나님께서 우리에게 은혜로 주신 것들을 알게 하려 하심이라 |We have not received the spirit of the world but the Spirit who is from God, that we may understand what God has freely given us.
27. 이사야 41장 10절| 두려워하지 말라 내가 너와 함께 함이라 놀라지 말라 나는 네 하나님이 됨이라 내가 너를 굳세게 하리라 참으로 너를 도와 주리라 참으로 나의 의로운 오른손으로 너를 붙들리라 |So do not fear, for I am with you; do not be dismayed, for I am your God. I will strengthen you and help you; I will uphold you with my righteous right hand.
28. 빌립보서 4장 13절| 내게 능력 주시는 자 안에서 내가 모든 것을 할 수 있느니라 |I can do everything through him who gives me strength.
29. 예레미야애가 3장 22-23절| 여호와의 인자와 긍휼이 무궁하시므로 우리가 진멸되지 아니함이니이다 이것들이 아침마다 새로우니 주의 성실하심이 크시도소이다 |Because of the LORD's great love we are not consumed, for his compassions never fail. They are new every morning; great is your faithfulness.
30. 민수기 23장 19절| 하나님은 사람이 아니시니 거짓말을 하지 않으시고 인생이 아니시니 후회가 없으시도다 어찌 그 말씀하신 바를 행하지 않으시며 하신 말씀을 실행하지 않으시랴 |God is not a man, that he should lie, nor a son of man, that he should change his mind. Does he speak and then not act? Does he promise and not fulfill?
31. 이사야 26장 3절| 주께서 심지가 견고한 자를 평강하고 평강하도록 지키시리니 이는 그가 주를 신뢰함이니이다 |You will keep in perfect peace him whose mind is steadfast, because he trusts in you.
32. 베드로전서 5장 7절| 너희 염려를 다 주께 맡기라 이는 그가 너희를 돌보심이라 |Cast all your anxiety on him because he cares for you.
33. 로마서 8장 32절| 자기 아들을 아끼지 아니하시고 우리 모든 사람을 위하여 내주신 이가 어찌 그 아들과 함께 모든 것을 우리에게 주시지 아니하겠느냐 |He who did not spare his own Son, but gave him up for us all--how will he not also, along with him, graciously give us all things?
34. 빌립보서 4장 19절| 나의 하나님이 그리스도 예수 안에서 영광 가운데 그 풍성한 대로 너희 모든 쓸 것을 채우시리라 |And my God will meet all your needs according to his glorious riches in Christ Jesus.
35. 히브리서 2장 18절| 그가 시험을 받아 고난을 당하셨은즉 시험 받는 자들을 능히 도우실 수 있느니라 |Because he himself suffered when he was tempted, he is able to help those who are being tempted.
36. 시편 119장 9-11절| 청년이 무엇으로 그의 행실을 깨끗하게 하리이까 주의 말씀만 지킬 따름이니이다 내가 주께 범죄하지 아니하려 하여 주의 말씀을 내 마음에 두었나이다 |How can a young man keep his way pure? By living according to your word. I seek you with all my heart; do not let me stray from your commands. I have hidden your word in my heart that I might not sin against you.
37. 마태복음 6장 33절| 그런즉 너희는 먼저 그의 나라와 그의 의를 구하라 그리하면 이 모든 것을 너희에게 더하시리라 |But seek first his kingdom and his righteousness, and all these things will be given to you as well.
38 누가복음 9장 23절| 또 무리에게 이르시되 아무든지 나를 따라오려거든 자기를 부인하고 날마다 제 십자가를 지고 나를 따를 것이니라 |Then he said to them all: "If anyone would come after me, he must deny himself and take up his cross daily and follow me.
39 요한일서 2장 15-16절| 이 세상이나 세상에 있는 것들을 사랑하지 말라 누구든지 세상을 사랑하면 아버지의 사랑이 그 안에 있지 아니하니 이는 세상에 있는 모든 것이 육신의 정욕과 안목의 정욕과 이생의 자랑이니 다 아버지께로부터 온 것이 아니요 세상으로부터 온 것이라 |Do not love the world or anything in the world. If anyone loves the world, the love of the Father is not in him. For everything in the world--the cravings of sinful man, the lust of his eyes and the boasting of what he has and does--comes not from the Father but from the world.
40. 로마서 12장 2절| 너희는 이 세대를 본받지 말고 오직 마음을 새롭게 함으로 변화를 받아 하나님의 선하시고 기뻐하시고 온전하신 뜻이 무엇인지 분별하도록 하라 |Do not conform any longer to the pattern of this world, but be transformed by the renewing of your mind. Then you will be able to test and approve what God's will is--his good, pleasing and perfect will.
41. 고린도전서 15장 58절| 그러므로 내 사랑하는 형제들아 견실하며 흔들리지 말고 항상 주의 일에 더욱 힘쓰는 자들이 되라 이는 너희 수고가 주 안에서 헛되지 않은 줄 앎이라 |Therefore, my dear brothers, stand firm. Let nothing move you. Always give yourselves fully to the work of the Lord, because you know that your labor in the Lord is not in vain.
42 히브리서 12장 3절| 너희가 피곤하여 낙심하지 않기 위하여 죄인들이 이같이 자기에게 거역한 일을 참으신 이를 생각하라 |Consider him who endured such opposition from sinful men, so that you will not grow weary and lose heart.
43. 마가복음 10장 45절| 인자가 온 것은 섬김을 받으려 함이 아니라 도리어 섬기려 하고 자기 목숨을 많은 사람의 대속물로 주려 함이니라 |For even the Son of Man did not come to be served, but to serve, and to give his life as a ransom for many.
44. 고린도후서 4장 5절| 우리는 우리를 전파하는 것이 아니라 오직 그리스도 예수의 주 되신 것과 또 예수를 위하여 우리가 너희의 종 된 것을 전파함이라 |For we do not preach ourselves, but Jesus Christ as Lord, and ourselves as your servants for Jesus' sake.
45. 잠언 3장 9-10절| 네 재물과 네 소산물의 처음 익은 열매로 여호와를 공경하라 그리하면 네 창고가 가득히 차고 네 포도즙 틀에 새 포도즙이 넘치리라 |Honor the LORD with your wealth, with the firstfruits of all your crops; then your barns will be filled to overflowing, and your vats will brim over with new wine.
46. 고린도후서 9장 6-7절| 이것이 곧 적게 심는 자는 적게 거두고 많이 심는 자는 많이 거둔다 하는 말이로다 각각 그 마음에 정한 대로 할 것이요 인색함으로나 억지로 하지 말지니 하나님은 즐겨 내는 자를 사랑하시느니라 |Remember this: Whoever sows sparingly will also reap sparingly, and whoever sows generously will also reap generously. Each man should give what he has decided in his heart to give, not reluctantly or under compulsion, for God loves a cheerful giver.
47. 사도행전 1장 8절| 오직 성령이 너희에게 임하시면 너희가 권능을 받고 예루살렘과 온 유대와 사마리아와 땅 끝까지 이르러 내 증인이 되리라 하시니라 |But you will receive power when the Holy Spirit comes on you; and you will be my witnesses in Jerusalem, and in all Judea and Samaria, and to the ends of the earth
48. 마태복음 28장 19-20절| 그러므로 너희는 가서 모든 민족을 제자로 삼아 아버지와 아들과 성령의 이름으로 세례를 베풀고 내가 너희에게 분부한 모든 것을 가르쳐 지키게 하라 볼지어다 내가 세상 끝날까지 너희와 항상 함께 있으리라 하시니라 |Therefore go and make disciples of all nations, baptizing them in the name of the Father and of the Son and of the Holy Spirit, and teaching them to obey everything I have commanded you. And surely I am with you always, to the very end of the age.
49. 요한복음 13장 34-35절| 새 계명을 너희에게 주노니 서로 사랑하라 내가 너희를 사랑한 것 같이 너희도 서로 사랑하라 너희가 서로 사랑하면 이로써 모든 사람이 너희가 내 제자인 줄 알리라 |A new command I give you: Love one another. As I have loved you, so you must love one another. By this all men will know that you are my disciples, if you love one another.
50. 요한일서 3장 18절| 자녀들아 우리가 말과 혀로만 사랑하지 말고 행함과 진실함으로 하자 |Dear children, let us not love with words or tongue but with actions and in truth.
51. 빌립보서 2장 3-4절| 아무 일에든지 다툼이나 허영으로 하지 말고 오직 겸손한 마음으로 각각 자기보다 남을 낫게 여기고 각각 자기 일을 돌볼뿐더러 또한 각각 다른 사람들의 일을 돌보아 나의 기쁨을 충만하게 하라 |Do nothing out of selfish ambition or vain conceit, but in humility consider others better than yourselves. Each of you should look not only to your own interests, but also to the interests of others.
52. 베드로전서 5장 5-6절| 젊은 자들아 이와 같이 장로들에게 순종하고 다 서로 겸손으로 허리를 동이라 하나님은 교만한 자를 대적하시되 겸손한 자들에게는 은혜를 주시느니라 그러므로 하나님의 능하신 손 아래에서 겸손하라 때가 되면 너희를 높이시리라 |Young men, in the same way be submissive to those who are older. All of you, clothe yourselves with humility toward one another, because, "God opposes the proud but gives grace to the humble." Humble yourselves, therefore, under God's mighty hand, that he may lift you up in due time.
53. 에베소서 5장 3절| 음행과 온갖 더러운 것과 탐욕은 너희 중에서 그 이름조차도 부르지 말라 이는 성도에게 마땅한 바니라 |But among you there must not be even a hint of sexual immorality, or of any kind of impurity, or of greed, because these are improper for God's holy people.
54. 베드로전서 2장 11절| 사랑하는 자들아 거류민과 나그네 같은 너희를 권하노니 영혼을 거슬러 싸우는 육체의 정욕을 제어하라 |Dear friends, I urge you, as aliens and strangers in the world, to abstain from sinful desires, which war against your soul.
55. 레위기 19장 11절| 너희는 도둑질하지 말며 속이지 말며 서로 거짓말하지 말며 | Do not steal. Do not lie. Do not deceive one another.
56. 사도행전 24장 16절| 이것으로 말미암아 나도 하나님과 사람에 대하여 항상 양심에 거리낌이 없기를 힘쓰나이다 |So I strive always to keep my conscience clear before God and man.
57. 히브리서 11장 6절| 믿음이 없이는 하나님을 기쁘시게 하지 못하나니 하나님께 나아가는 자는 반드시 그가 계신 것과 또한 그가 자기를 찾는 자들에게 상 주시는 이심을 믿어야 할지니라 |And without faith it is impossible to please God, because anyone who comes to him must believe that he exists and that he rewards those who earnestly seek him.
58. 로마서 4장 20-21절| 믿음이 없어 하나님의 약속을 의심하지 않고 믿음으로 견고하여져서 하나님께 영광을 돌리며 약속하신 그것을 또한 능히 이루실 줄을 확신하였으니 |Yet he did not waver through unbelief regarding the promise of God, but was strengthened in his faith and gave glory to God, being fully persuaded that God had power to do what he had promised.
59. 갈라디아서 6장 9-10절| 우리가 선을 행하되 낙심하지 말지니 포기하지 아니하면 때가 이르매 거두리라 그러므로 우리는 기회 있는 대로 모든 이에게 착한 일을 하되 더욱 믿음의 가정들에게 할지니라 |Let us not become weary in doing good, for at the proper time we will reap a harvest if we do not give up. Therefore, as we have opportunity, let us do good to all people, especially to those who belong to the family of believers.
60. 마태복음 5장 16절| 이같이 너희 빛이 사람 앞에 비치게 하여 그들로 너희 착한 행실을 보고 하늘에 계신 너희 아버지께 영광을 돌리게 하라 |In the same way, let your light shine before men, that they may see your good deeds and praise your Father in heaven.
`;


function parseVerses(str) {
  return str.trim().split('\n').map((line, i) => {
    const parts = line.split('|').map(s => s.trim());  
    return {
      id: i,
      title: parts[0] || '',
      text: parts[1] || '',
      textEn: parts[2] || '',
      favorite: false
     
    };
  });
}

// 초기화
let originalVerses = loadSavedVerses() || parseVerses(originalVersesStr);
let favoriteIds = JSON.parse(localStorage.getItem(STORAGE_KEY_FAVORITES) || '[]');

// favorite 상태 복원
originalVerses = originalVerses.map((v, i) => ({
  ...v,
  id: i,
  favorite: favoriteIds.includes(i)
}));

let verses = [...originalVerses];
let current = 0;
let isHidden = false;
let isRandomMode = false;
let showOnlyFavorites = false;




function renderVerse() {

  const verse = verses[current];
  if (!verse) return;
  document.getElementById('verseTitle').textContent = verse.title;
  document.getElementById('verseText').textContent = verse.text;
  document.getElementById('verseTextEn').textContent = verse.textEn;
  document.getElementById('favoriteCheckbox').checked = verse.favorite;

}


function applyAnimation(direction = 'left') {
  const verseBoxes = document.querySelectorAll('.verse-box, .favorite-box');
  verseBoxes.forEach((box) => {
    box.classList.remove('animate-left', 'animate-right'); // 초기화
    void box.offsetWidth; // 리플로우 강제 → 연속 클릭 시 애니메이션 재실행됨
    box.classList.add(direction === 'left' ? 'animate-left' : 'animate-right');
  });
}

function prevVerse() {
applyAnimation('right');
  current = (current - 1 + verses.length) % verses.length;
  renderVerse();
}

function nextVerse() {
    applyAnimation('left');
  current = (current + 1) % verses.length;
  renderVerse();
}

function toggleVerse() {
  isHidden = !isHidden;
  document.getElementById("toggleButton").innerText = isHidden ? "보여" : "숨겨";

  const textElKo = document.getElementById("verseText").parentElement;
  const textElEn = document.getElementById("verseTextEn").parentElement;

  const englishHidden = localStorage.getItem("englishVerseHidden") === "true";

  if (isHidden) {
    textElKo.style.display = "none";
    textElEn.style.display = "none";
  } else {
    textElKo.style.display = "block";

    // 영어 말씀이 숨김 상태로 저장되어 있다면 block 하지 않음
    if (!englishHidden) {
      textElEn.style.display = "block";
    }
  }

  renderVerse();
}

function toggleMode() {
  const modeButton = document.getElementById('modeToggleButton');

  if (!isRandomMode) {
    let shuffled;
    let attempts = 0;
    do {
      shuffled = [...verses];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      attempts++;
    } while (arraysAreEqual(shuffled, verses) && attempts < 10);

    verses = shuffled;
    isRandomMode = true;
    modeButton.textContent = "순차";
  } else {
    verses = showOnlyFavorites ? originalVerses.filter(v => v.favorite) : [...originalVerses];
    isRandomMode = false;
    modeButton.textContent = "랜덤";
  }

  current = 0;
  renderVerse();
}

// 🔧 배열 비교 함수 (같은 순서인지 확인)
function arraysAreEqual(arr1, arr2) {
  if (arr1.length !== arr2.length) return false;
  for (let i = 0; i < arr1.length; i++) {
    if (arr1[i] !== arr2[i]) return false;
  }
  return true;
}


function updateFavorite() {
  const verse = verses[current];
  verse.favorite = document.getElementById('favoriteCheckbox').checked;

  const original = originalVerses.find(v => v.id === verse.id);
  if (original) original.favorite = verse.favorite;

  const newFavorites = originalVerses.filter(v => v.favorite).map(v => v.id);
  localStorage.setItem(STORAGE_KEY_FAVORITES, JSON.stringify(newFavorites));
  saveVersesToStorage(originalVerses);
}

function toggleFavoriteCheckbox() {
  const checkbox = document.getElementById('favoriteCheckbox');
  checkbox.checked = !checkbox.checked;
  updateFavorite();
   parseTextareaToJSON2();
}

function toggleFavorites() {
  const button = document.getElementById("favoriteToggleButton");
  showOnlyFavorites = !showOnlyFavorites;

  if (showOnlyFavorites) {
    const favoritesOnly = originalVerses.filter(v => v.favorite);

    if (favoritesOnly.length === 0) {
      alert("즐겨찾기 추가한 말씀이 하나도 없습니다.");
      showOnlyFavorites = false; // 상태를 다시 원래대로 되돌림
      return; // 아래 코드 실행 중단
    }

    verses = favoritesOnly;
    button.textContent = "모두";
  } else {
    verses = [...originalVerses];
    button.textContent = "즐찾";
  }

  current = 0;
  renderVerse();

  // 즐겨찾기 id 배열 반환 및 콘솔 출력
  const favIds = getFavoriteIds();
  console.log(favIds);
  return favIds;
}


// 스와이프 감지
let startX = 0;
let endX = 0;
const verseContainer = document.getElementById('verseContainer');
// 화면 전체에 이벤트 적용
document.addEventListener('touchstart', e => {
  if (e.target.type === 'checkbox') return;
  startX = e.touches[0].clientX;
});

document.addEventListener('touchend', e => {
  if (e.target.type === 'checkbox') return;
  endX = e.changedTouches[0].clientX;
  handleSwipe();
});

document.addEventListener('mousedown', e => {
  if (e.target.type === 'checkbox') return;
  startX = e.clientX;
});

document.addEventListener('mouseup', e => {
  if (e.target.type === 'checkbox') return;
  endX = e.clientX;
  handleSwipe();
});


// 즐겨찾기 추가된 번호(id) 배열 반환 함수
function getFavoriteIds() {
  return originalVerses.filter(v => v.favorite).map(v => v.id);
}

let lastSwipeTime = 0;
let swipeCount = 0;

function handleSwipe() {
  const diff = endX - startX;
  const now = Date.now();

  // 연속 스와이프 여부 판단 (400ms 이내 두 번)
  if (Math.abs(diff) > 50) {
    if (now - lastSwipeTime < 400) {
      swipeCount++;
    } else {
      swipeCount = 1;
    }

    lastSwipeTime = now;

    if (swipeCount >= 2) {
      // 두 번 빠르게 스와이프하면 10칸 점프
      if (diff > 0) {
        jumpVerse(-10); // 오른쪽으로 스와이프 = 이전
      } else {
        jumpVerse(10); // 왼쪽으로 스와이프 = 다음
      }
      swipeCount = 0; // 리셋
    } else {
      // 일반 스와이프
      diff > 0 ? prevVerse() : nextVerse();
    }
  }
}

function jumpVerse(step) {
  applyAnimation(step > 0 ? 'left' : 'right');
  current = (current + step + verses.length) % verses.length;
  renderVerse();
}

// 편집
let isEditing = false;

function toggleEditMode() {
  const editContainer = document.getElementById('editContainer');
  const textarea = document.getElementById('editTextarea');
  isEditing = !isEditing;

  if (isEditing) {
    const str = originalVerses.map(v => `${v.title}| ${v.text}| ${v.textEn || ''}`).join('\n');
    textarea.value = str;
    editContainer.style.display = 'flex';
  } else {
    editContainer.style.display = 'none';
  }
}

function saveEditedVerses() {
  const editedText = document.getElementById('editTextarea').value.trim();
  const lines = editedText.split('\n').filter(line => line.trim() !== '');
  const isValid = lines.every(line => {
    const parts = line.split('|');
    return parts.length === 3 && parts[0].trim() && parts[1].trim();
  });

  if (!isValid) {
    showFormatError();
    return;
  }

  const newVerses = lines.map((line, idx) => {
const [title, text, textEn] = line.split('|').map(str => str.trim());
return { id: idx, title, text, textEn: textEn || '', favorite: false };
  });

  for (let v of newVerses) {
    const existing = originalVerses.find(o => o.title === v.title && o.text === v.text);
    if (existing) v.favorite = existing.favorite;
  }

  originalVerses = [...newVerses];
  verses = showOnlyFavorites ? originalVerses.filter(v => v.favorite) : [...originalVerses];

  // 저장
  saveVersesToStorage(originalVerses);
  localStorage.setItem(STORAGE_KEY_FAVORITES, JSON.stringify(originalVerses.filter(v => v.favorite).map(v => v.id)));

  current = 0;
  toggleEditMode();
  renderVerse();
}

function cancelEdit() {
  toggleEditMode();
}

function resetToOriginal() {
  const textarea = document.getElementById('editTextarea');
  textarea.value = originalVersesStr.trim();
  navigator.clipboard.writeText(originalVersesStr2)
    .then(() => {    
    })
    .catch(err => {      
    });
}

function showFormatError() {
  if (!document.getElementById('formatErrorBox')) {
    const errorBox = document.createElement('div');
    errorBox.id = 'formatErrorBox';
    errorBox.style.position = 'fixed';
    errorBox.style.top = '50%';
    errorBox.style.left = '50%';
    errorBox.style.transform = 'translate(-50%, -50%)';
    errorBox.style.backgroundColor = '#2a2a2a';
    errorBox.style.color = '#fff';
    errorBox.style.padding = '20px';
    errorBox.style.borderRadius = '10px';
    errorBox.style.zIndex = '10';
    errorBox.style.textAlign = 'center';
    errorBox.innerHTML = `
      <p>편집 형식에 <br>어긋나게 편집하셨네요.<br>죄송하지만 창을 닫습니다.</p>
      <button id="formatErrorOkButton" style="margin-top:15px; padding:8px 20px; border:none; border-radius:5px; background:#FFD95A; color:#121212; font-weight:bold; cursor:pointer;">확인</button>
    `;
    document.body.appendChild(errorBox);
    document.getElementById('formatErrorOkButton').onclick = () => {
      errorBox.remove();
      toggleEditMode();
    };
  }
}

// 최초 렌더링
renderVerse();

// 페이지가 로딩된 후 2초 후에 자동 실행
window.addEventListener('load', () => {
  setTimeout(() => {
    saveVersesToStorage(originalVerses);
  }, 2000);
});

  document.getElementById("game1").addEventListener("click", function () {  
    saveVersesToStorage(originalVerses);
    location.href = "game1.htm";
  });

  document.getElementById("game2").addEventListener("click", function () {  
    saveVersesToStorage(originalVerses);
    location.href = "game2.htm";
  });

  document.getElementById("game3").addEventListener("click", function () {  
    saveVersesToStorage(originalVerses);
    location.href = "game3.htm";
  });

//한글 영문 바꾸기
function krEnVerse() {
  // 1. 저장된 데이터 불러오기
  const savedVerses = loadSavedVerses();
  if (!savedVerses) {
    alert("저장된 구절 데이터를 불러올 수 없습니다.");
    return;
  }

  // 2. text ↔ textEn 위치 변경
  const swapped = savedVerses.map(item => {
    const temp = item.text;
    item.text = item.textEn;
    item.textEn = temp;
    return item;
  });

  // 3. 다시 저장
  localStorage.setItem(STORAGE_KEY_VERSES, JSON.stringify(swapped));

  // 4. 전역 변수 업데이트
  verses = swapped;
  originalVerses = swapped;

  // 5. 화면 다시 렌더링
  if (typeof renderVerse === "function") {
    renderVerse();
  } else {
    alert("renderVerse() 함수가 정의되어 있지 않습니다.");
  }

  // 6. textarea 내용 갱신
  const textarea = document.getElementById('editTextarea');
  if (textarea) {
    const str = originalVerses.map(v => `${v.title}| ${v.text}| ${v.textEn || ''}`).join('\n');
    textarea.value = str;
  }
}

</script>

<script>
function openHelpPopup() {
  hideSettingsMenu()
  if (document.getElementById("helpPopup")) return;

  const popupOverlay = document.createElement("div");
  popupOverlay.id = "helpPopup";
  popupOverlay.className = "help-popup-overlay";

  const popupContent = document.createElement("div");
  popupContent.className = "help-popup-container";

  popupContent.innerHTML = `

    <div class="help-title">최종수정일 : 2025.06.01</div>
    <textarea class="help-textarea" readonly>
📝 힘이되는 성경암송 30구절 설명서

1.숨겨/보여 : 말씀 내용을 숨기거나 보이도록 합니다.

2.랜덤/순차 : 말씀 보이는 순서를 섞어서 랜덤으로 나오게 하거나, 순차적으로 나오게 합니다.

3.즐찾/모두 : 모든 말씀이 나오게 하거나, 즐겨찾기에 추가된 말씀만 나오도록 설정할 수 있습니다.

4.설정/말씀 편집하기 : 말씀을 편집하거나 추가할 수 있습니다. 전문가모드 입니다. 전체를 복사해서 카톡이나 구글드라이브로 내용을 백업한 다음 pc 에서 편집 작업을 완료한후 다시 핸드폰으로 글을 가져오면 편리합니다. 초기화 버튼이 있어서 내용이 꼬이거나 실수를 하더라도 다시 원상복구가 가능합니다.

5.게임 : 게임은 3가지 지원하며 말씀을 재미있게 외울수 있도록 도와줄것입니다. 상단의 즐찾을 누르면 즐겨찾기 추가된 리스트만 반복하기 때문에 중점적으로 외우려고하는 말씀이 있을때 사용하시면 유용합니다. 말씀편집 메뉴를 통해 말씀을 수정하거나 업데이트 하면 자동으로 게임도 업데이트가 됩니다. 

6.메인/보조말씀 위치변경 : 이것은 메인말씀과 보조말씀 위치를 바꿔주는 메뉴입니다. 이것을 클릭하면 한글말씀과 영문말씀 위치가 바뀌게 되며 게임을 할때도 한글이 아니라 영문으로 게임을 진행하게 됩니다. 영어도 외우고 싶은분들을 위해 마련한 기능입니다.

7.보조말씀 숨기기/보이기 : 이 메뉴는 토글로 작동합니다. 한번 누르면 보조말씀(영문)을 숨기게되고 한번더 누르면 보이게 됩니다. 나는 영어는 필요없어 라고 생각하시는분들은 이걸 눌러서 감추고 한글말씀을 외우는데 집중하시면 됩니다.

8.유용한 기능 : 손가락으로 좌우로 천천히 넘기면 말씀이 한 단계씩 변합니다. 하지만 빠르게 두 번 연속 넘기면 10개씩 단번에 넘어갑니다.

9.오프라인 가능 : 모든것이 오프라인으로 이용가능합니다. 온라인에 접속하는 형태가 아닌 어플에 포함된 html 문서로만 작동이 되기 때문에 인터넷 연결없이도 모든것을 이용하실수가 있습니다. 

10.저작권 : 저작권이 완료된 개역한글, KJV(영문) 성경말씀을 사용했습니다. 개역개정, NIV(영문) 성경말씀을 사용하고싶었으나 저작권법에 걸리기 때문에 사용하지 못했음을 알려드리니 필요하시면 직접 편집해서 사용하시면 됩니다. 추천드리는 조합은 네비게이토 암송말씀 60구절 개역개정, NIV(영문) 조합을 추천합니다.
    </textarea>
    <div class="help-button-box">
      <button class="help-close-btn" onclick="closeHelpPopup()">닫기</button>
    </div>
  `;

  popupOverlay.appendChild(popupContent);
  document.body.appendChild(popupOverlay);

  if (!document.getElementById("helpPopupStyle")) {
    const style = document.createElement("style");
    style.id = "helpPopupStyle";
    style.textContent = `
/* 팝업 전체 화면 덮기 */
.help-popup-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background-color: rgba(10, 10, 10, 0.95);
  display: flex;
  justify-content: center;
  align-items: center; /* stretch → center로 변경해서 중앙 정렬 */
  padding: 5px; /* 가장자리 여백 추가 */
  z-index: 9999;
  box-sizing: border-box;
  overflow: auto; /* 혹시 넘칠 때 스크롤 */
}

/* 팝업 본체 */
.help-popup-container {
  background-color: #1c1c1c;
  border-radius: 8px; /* 살짝 둥글게 */
  padding: 5px 0 10px 0;
  width: 100%;
  height: 100%; 

  box-sizing: border-box;
  color: #e0e0e0;
  font-family: 'Segoe UI', sans-serif;
  font-size: 14px;
  line-height: 1.4;
  display: flex;
  flex-direction: column;
}

/* 제목 줄 */
.help-title {
  margin: 2px 0 2px 0;
   font-size: 1rem;
  color: #ffffff;
  padding-left: 4px;
   line-height: 1.2;

}

.help-textarea {
  flex: 1;
  width: 100%;
  resize: none;
  overflow-y: auto;
  background-color: #2a2a2a;
  color: #ffffff;
  border: 1px solid #555;
  border-radius: 4px;
  padding: 12px;
   font-size: 1rem;
  box-sizing: border-box;
  line-height: 1.4;
  margin-top: 10px;
  min-height: 200px; /* 기본값, 화면에 따라 커짐 */
  max-height: none;  /* 최대 높이 제한 해제 */
}

/* 닫기 버튼 영역 */
.help-button-box {
  text-align: right;
  margin: 15px 10px 0 0;
}

/* 닫기 버튼 */
.help-close-btn {
  background-color: #3a3a3a;
  color: #ffffff;
  border: none;
  padding: 8px 20px;
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.help-close-btn:hover {
  background-color: #555;
}
`;
    document.head.appendChild(style);
  }
}

function closeHelpPopup() {
  const popup = document.getElementById("helpPopup");
  if (popup) popup.remove();

location.reload(true);
}



</script>
<script>
  // 초기 상태를 로컬스토리지에서 불러오기
  document.addEventListener("DOMContentLoaded", () => {
    const textElEn = document.getElementById("verseTextEn")?.parentElement;
    const btn = document.getElementById("toggleEnglishVerseBtn");
    const savedState = localStorage.getItem("englishVerseHidden");

    if (!textElEn || !btn) return;

    if (savedState === "true") {
      textElEn.style.display = "none";
      btn.innerText = "📖 보조 말씀 보이기";
    } else {
      textElEn.style.display = "";
      btn.innerText = "📖 보조 말씀 숨기기";
    }
  });

  function toggleEnglishVerse() {
    const textElEn = document.getElementById("verseTextEn")?.parentElement;
    const btn = document.getElementById("toggleEnglishVerseBtn");

    if (!textElEn || !btn) return;

    const isHidden = textElEn.style.display === "none";

    if (isHidden) {
      textElEn.style.display = "";
      btn.innerText = "📖 보조 말씀 숨기기";
      localStorage.setItem("englishVerseHidden", "false");
    } else {
      textElEn.style.display = "none";
      btn.innerText = "📖 보조 말씀 보이기";
      localStorage.setItem("englishVerseHidden", "true");
    }
  }
</script>

</body>
</html>
